(function(e,f){var g=e;g.version='0.8.7';g.protocol=1;g.transports=[];g.j=[];g.sockets={};g.connect=function(a,b){var c=g.util.parseUri(a),uuri,socket;if(f&&f.location){c.protocol=c.protocol||f.location.protocol.slice(0,-1);c.host=c.host||(f.document?f.document.domain:f.location.hostname);c.port=c.port||f.location.port}uuri=g.util.uniqueUri(c);var d={host:c.host,secure:'https'==c.protocol,port:c.port||('https'==c.protocol?443:80),query:c.query||''};g.util.merge(d,b);if(d['force new connection']||!g.sockets[uuri]){socket=new g.Socket(d)}if(!d['force new connection']&&socket){g.sockets[uuri]=socket}socket=socket||g.sockets[uuri];return socket.of(c.path.length>1?c.path:'')}})('object'===typeof module?module.exports:(this.io={}),this);(function(g,h){var k=g.util={};var n=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;var p=['source','protocol','authority','userInfo','user','password','host','port','relative','path','directory','file','query','anchor'];k.parseUri=function(a){var m=n.exec(a||''),uri={},i=14;while(i--){uri[p[i]]=m[i]||''}return uri};k.uniqueUri=function(a){var b=a.protocol,host=a.host,port=a.port;if('document'in h){host=host||document.domain;port=port||(b=='https'&&document.location.protocol!=='https:'?443:document.location.port)}else{host=host||'localhost';if(!port&&b=='https'){port=443}}return(b||'http')+'://'+host+':'+(port||80)};k.query=function(a,b){var c=k.chunkQuery(a||''),components=[];k.merge(c,k.chunkQuery(b||''));for(var d in c){if(c.hasOwnProperty(d)){components.push(d+'='+c[d])}}return components.length?'?'+components.join('&'):''};k.chunkQuery=function(a){var b={},params=a.split('&'),i=0,l=params.length,kv;for(;i<l;++i){kv=params[i].split('=');if(kv[0]){b[kv[0]]=decodeURIComponent(kv[1])}}return b};var q=false;k.load=function(a){if('document'in h&&document.readyState==='complete'||q){return a()}k.on(h,'load',a,false)};k.on=function(a,b,c,d){if(a.attachEvent){a.attachEvent('on'+b,c)}else if(a.addEventListener){a.addEventListener(b,c,d)}};k.request=function(a){if(a&&'undefined'!=typeof XDomainRequest){return new XDomainRequest()}if('undefined'!=typeof XMLHttpRequest&&(!a||k.ua.hasCORS)){return new XMLHttpRequest()}if(!a){try{return new ActiveXObject('Microsoft.XMLHTTP')}catch(e){}}return null};if('undefined'!=typeof window){k.load(function(){q=true})}k.defer=function(a){if(!k.ua.webkit||'undefined'!=typeof importScripts){return a()}k.load(function(){setTimeout(a,100)})};k.merge=function merge(a,b,c,d){var e=d||[],depth=typeof c=='undefined'?2:c,prop;for(prop in b){if(b.hasOwnProperty(prop)&&k.indexOf(e,prop)<0){if(typeof a[prop]!=='object'||!depth){a[prop]=b[prop];e.push(b[prop])}else{k.merge(a[prop],b[prop],depth-1,e)}}}return a};k.mixin=function(a,b){k.merge(a.prototype,b.prototype)};k.inherit=function(a,b){function f(){};f.prototype=b.prototype;a.prototype=new f};k.isArray=Array.isArray||function(a){return Object.prototype.toString.call(a)==='[object Array]'};k.intersect=function(a,b){var c=[],longest=a.length>b.length?a:b,shortest=a.length>b.length?b:a;for(var i=0,l=shortest.length;i<l;i++){if(~k.indexOf(longest,shortest[i]))c.push(shortest[i])}return c}k.indexOf=function(a,o,i){if(Array.prototype.indexOf){return Array.prototype.indexOf.call(a,o,i)}for(var j=a.length,i=i<0?i+j<0?0:i+j:i||0;i<j&&a[i]!==o;i++){}return j<=i?-1:i};k.toArray=function(a){var b=[];for(var i=0,l=a.length;i<l;i++)b.push(a[i]);return b};k.ua={};k.ua.hasCORS='undefined'!=typeof XMLHttpRequest&&(function(){try{var a=new XMLHttpRequest()}catch(e){return false}return a.withCredentials!=undefined})();k.ua.webkit='undefined'!=typeof navigator&&/webkit/i.test(navigator.userAgent)})('undefined'!=typeof io?io:module.exports,this);(function(e,f){e.EventEmitter=EventEmitter;function EventEmitter(){};EventEmitter.prototype.on=function(a,b){if(!this.$events){this.$events={}}if(!this.$events[a]){this.$events[a]=b}else if(f.util.isArray(this.$events[a])){this.$events[a].push(b)}else{this.$events[a]=[this.$events[a],b]}return this};EventEmitter.prototype.addListener=EventEmitter.prototype.on;EventEmitter.prototype.once=function(a,b){var c=this;function on(){c.removeListener(a,on);b.apply(this,arguments)};on.listener=b;this.on(a,on);return this};EventEmitter.prototype.removeListener=function(a,b){if(this.$events&&this.$events[a]){var c=this.$events[a];if(f.util.isArray(c)){var d=-1;for(var i=0,l=c.length;i<l;i++){if(c[i]===b||(c[i].listener&&c[i].listener===b)){d=i;break}}if(d<0){return this}c.splice(d,1);if(!c.length){delete this.$events[a]}}else if(c===b||(c.listener&&c.listener===b)){delete this.$events[a]}}return this};EventEmitter.prototype.removeAllListeners=function(a){if(this.$events&&this.$events[a]){this.$events[a]=null}return this};EventEmitter.prototype.listeners=function(a){if(!this.$events){this.$events={}}if(!this.$events[a]){this.$events[a]=[]}if(!f.util.isArray(this.$events[a])){this.$events[a]=[this.$events[a]]}return this.$events[a]};EventEmitter.prototype.emit=function(a){if(!this.$events){return false}var b=this.$events[a];if(!b){return false}var c=Array.prototype.slice.call(arguments,1);if('function'==typeof b){b.apply(this,c)}else if(f.util.isArray(b)){var d=b.slice();for(var i=0,l=d.length;i<l;i++){d[i].apply(this,c)}}else{return false}return true}})('undefined'!=typeof io?io:module.exports,'undefined'!=typeof io?io:module.parent.exports);(function(e,g){"use strict";if(g&&g.parse){return e.JSON={parse:g.parse,stringify:g.stringify}}var h=e.JSON={};function f(n){return n<10?'0'+n:n}function date(d,a){return isFinite(d.valueOf())?d.getUTCFullYear()+'-'+f(d.getUTCMonth()+1)+'-'+f(d.getUTCDate())+'T'+f(d.getUTCHours())+':'+f(d.getUTCMinutes())+':'+f(d.getUTCSeconds())+'Z':null};var l=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(b){escapable.lastIndex=0;return escapable.test(b)?'"'+b.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function str(a,b){var i,k,v,length,mind=gap,partial,value=b[a];if(value instanceof Date){value=date(a)}if(typeof rep==='function'){value=rep.call(b,a,value)}switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null'}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null'}v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v}if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==='string'){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v)}}}}v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v}}h.stringify=function(a,b,c){var i;gap='';indent='';if(typeof c==='number'){for(i=0;i<c;i+=1){indent+=' '}}else if(typeof c==='string'){indent=c}rep=b;if(b&&typeof b!=='function'&&(typeof b!=='object'||typeof b.length!=='number')){throw new Error('JSON.stringify');}return str('',{'':a})};h.parse=function(c,d){var j;function walk(a,b){var k,v,value=a[b];if(value&&typeof value==='object'){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return d.call(a,b,value)}c=String(c);l.lastIndex=0;if(l.test(c)){c=c.replace(l,function(a){return'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(c.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+c+')');return typeof d==='function'?walk({'':j},''):j}throw new SyntaxError('JSON.parse');}})('undefined'!=typeof io?io:module.exports,typeof JSON!=='undefined'?JSON:undefined);(function(f,g){var h=f.parser={};var j=h.packets=['disconnect','connect','heartbeat','message','json','event','ack','error','noop'];var k=h.reasons=['transport not supported','client not handshaken','unauthorized'];var m=h.advice=['reconnect'];var n=g.JSON,indexOf=g.util.indexOf;h.encodePacket=function(a){var b=indexOf(j,a.type),id=a.id||'',endpoint=a.endpoint||'',ack=a.ack,data=null;switch(a.type){case'error':var c=a.reason?indexOf(k,a.reason):'',adv=a.advice?indexOf(m,a.advice):'';if(c!==''||adv!=='')data=c+(adv!==''?('+'+adv):'');break;case'message':if(a.data!=='')data=a.data;break;case'event':var d={name:a.name};if(a.args&&a.args.length){d.args=a.args}data=n.stringify(d);break;case'json':data=n.stringify(a.data);break;case'connect':if(a.qs)data=a.qs;break;case'ack':data=a.ackId+(a.args&&a.args.length?'+'+n.stringify(a.args):'');break}var e=[b,id+(ack=='data'?'+':''),endpoint];if(data!==null&&data!==undefined)e.push(data);return e.join(':')};h.encodePayload=function(a){var b='';if(a.length==1)return a[0];for(var i=0,l=a.length;i<l;i++){var c=a[i];b+='\ufffd'+c.length+'\ufffd'+a[i]}return b};var o=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;h.decodePacket=function(a){var b=a.match(o);if(!b)return{};var c=b[2]||'',a=b[5]||'',packet={type:j[b[1]],endpoint:b[4]||''};if(c){packet.id=c;if(b[3])packet.ack='data';else packet.ack=true}switch(packet.type){case'error':var b=a.split('+');packet.reason=k[b[0]]||'';packet.advice=m[b[1]]||'';break;case'message':packet.data=a||'';break;case'event':try{var d=n.parse(a);packet.name=d.name;packet.args=d.args}catch(e){}packet.args=packet.args||[];break;case'json':try{packet.data=n.parse(a)}catch(e){}break;case'connect':packet.qs=a||'';break;case'ack':var b=a.match(/^([0-9]+)(\+)?(.*)/);if(b){packet.ackId=b[1];packet.args=[];if(b[3]){try{packet.args=b[3]?n.parse(b[3]):[]}catch(e){}}}break;case'disconnect':case'heartbeat':break};return packet};h.decodePayload=function(a){if(a.charAt(0)=='\ufffd'){var b=[];for(var i=1,length='';i<a.length;i++){if(a.charAt(i)=='\ufffd'){b.push(h.decodePacket(a.substr(i+1).substr(0,length)));i+=Number(length)+1;length=''}else{length+=a.charAt(i)}}return b}else{return[h.decodePacket(a)]}}})('undefined'!=typeof io?io:module.exports,'undefined'!=typeof io?io:module.parent.exports);(function(c,d){c.Transport=Transport;function Transport(a,b){this.socket=a;this.sessid=b};d.util.mixin(Transport,d.EventEmitter);Transport.prototype.onData=function(a){this.clearCloseTimeout();if(this.connected||this.connecting||this.reconnecting){this.setCloseTimeout()}if(a!==''){var b=d.parser.decodePayload(a);if(b&&b.length){for(var i=0,l=b.length;i<l;i++){this.onPacket(b[i])}}}return this};Transport.prototype.onPacket=function(a){if(a.type=='heartbeat'){return this.onHeartbeat()}if(a.type=='connect'&&a.endpoint==''){this.onConnect()}this.socket.onPacket(a);return this};Transport.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var a=this;this.closeTimeout=setTimeout(function(){a.onDisconnect()},this.socket.closeTimeout)}};Transport.prototype.onDisconnect=function(){if(this.close&&this.open)this.close();this.clearTimeouts();this.socket.onDisconnect();return this};Transport.prototype.onConnect=function(){this.socket.onConnect();return this}Transport.prototype.clearCloseTimeout=function(){if(this.closeTimeout){clearTimeout(this.closeTimeout);this.closeTimeout=null}};Transport.prototype.clearTimeouts=function(){this.clearCloseTimeout();if(this.reopenTimeout){clearTimeout(this.reopenTimeout)}};Transport.prototype.packet=function(a){this.send(d.parser.encodePacket(a))};Transport.prototype.onHeartbeat=function(a){this.packet({type:'heartbeat'})};Transport.prototype.onOpen=function(){this.open=true;this.clearCloseTimeout();this.socket.onOpen()};Transport.prototype.onClose=function(){var a=this;this.open=false;this.socket.onClose();this.onDisconnect()};Transport.prototype.prepareUrl=function(){var a=this.socket.options;return this.scheme()+'://'+a.host+':'+a.port+'/'+a.resource+'/'+d.protocol+'/'+this.name+'/'+this.sessid};Transport.prototype.ready=function(a,b){b.call(this)}})('undefined'!=typeof io?io:module.exports,'undefined'!=typeof io?io:module.parent.exports);(function(j,k,l){j.Socket=Socket;function Socket(a){this.options={port:80,secure:false,document:'document'in l?document:false,resource:'socket.io',transports:k.transports,'connect timeout':10000,'try multiple transports':true,'reconnect':true,'reconnection delay':500,'reconnection limit':Infinity,'reopen delay':3000,'max reconnection attempts':10,'sync disconnect on unload':true,'auto connect':true,'flash policy port':10843};k.util.merge(this.options,a);this.connected=false;this.open=false;this.connecting=false;this.reconnecting=false;this.namespaces={};this.buffer=[];this.doBuffer=false;if(this.options['sync disconnect on unload']&&(!this.isXDomain()||k.util.ua.hasCORS)){var b=this;k.util.on(l,'beforeunload',function(){b.disconnectSync()},false)}if(this.options['auto connect']){this.connect()}};k.util.mixin(Socket,k.EventEmitter);Socket.prototype.of=function(a){if(!this.namespaces[a]){this.namespaces[a]=new k.SocketNamespace(this,a);if(a!==''){this.namespaces[a].packet({type:'connect'})}}return this.namespaces[a]};Socket.prototype.publish=function(){this.emit.apply(this,arguments);var a;for(var i in this.namespaces){if(this.namespaces.hasOwnProperty(i)){a=this.of(i);a.$emit.apply(a,arguments)}}};function empty(){};Socket.prototype.handshake=function(b){var c=this,options=this.options;function complete(a){if(a instanceof Error){c.onError(a.message)}else{b.apply(null,a.split(':'))}};var d=['http'+(options.secure?'s':'')+':/',options.host+':'+options.port,options.resource,k.protocol,k.util.query(this.options.query,'t='+ +new Date)].join('/');if(this.isXDomain()&&!k.util.ua.hasCORS){var e=document.getElementsByTagName('script')[0],script=document.createElement('script');script.src=d+'&jsonp='+k.j.length;e.parentNode.insertBefore(script,e);k.j.push(function(a){complete(a);script.parentNode.removeChild(script)})}else{var f=k.util.request();f.open('GET',d,true);f.onreadystatechange=function(){if(f.readyState==4){f.onreadystatechange=empty;if(f.status==200){complete(f.responseText)}else{!c.reconnecting&&c.onError(f.responseText)}}};f.send(null)}};Socket.prototype.getTransport=function(a){var b=a||this.transports,match;for(var i=0,transport;transport=b[i];i++){if(k.Transport[transport]&&k.Transport[transport].check(this)&&(!this.isXDomain()||k.Transport[transport].xdomainCheck())){return new k.Transport[transport](this,this.sessionid)}}return null};Socket.prototype.connect=function(g){if(this.connecting){return this}var h=this;this.handshake(function(c,d,e,f){h.sessionid=c;h.closeTimeout=e*1000;h.heartbeatTimeout=d*1000;h.transports=k.util.intersect(f.split(','),h.options.transports);function connect(b){if(h.transport)h.transport.clearTimeouts();h.transport=h.getTransport(b);if(!h.transport)return h.publish('connect_failed');h.transport.ready(h,function(){h.connecting=true;h.publish('connecting',h.transport.name);h.transport.open();if(h.options['connect timeout']){h.connectTimeoutTimer=setTimeout(function(){if(!h.connected){h.connecting=false;if(h.options['try multiple transports']){if(!h.remainingTransports){h.remainingTransports=h.transports.slice(0)}var a=h.remainingTransports;while(a.length>0&&a.splice(0,1)[0]!=h.transport.name){}if(a.length){connect(a)}else{h.publish('connect_failed')}}}},h.options['connect timeout'])}})}connect();h.once('connect',function(){clearTimeout(h.connectTimeoutTimer);g&&typeof g=='function'&&g()})});return this};Socket.prototype.packet=function(a){if(this.connected&&!this.doBuffer){this.transport.packet(a)}else{this.buffer.push(a)}return this};Socket.prototype.setBuffer=function(v){this.doBuffer=v;if(!v&&this.connected&&this.buffer.length){this.transport.payload(this.buffer);this.buffer=[]}};Socket.prototype.disconnect=function(){if(this.connected){if(this.open){this.of('').packet({type:'disconnect'})}this.onDisconnect('booted')}return this};Socket.prototype.disconnectSync=function(){var a=k.util.request(),uri=this.resource+'/'+k.protocol+'/'+this.sessionid;a.open('GET',uri,true);this.onDisconnect('booted')};Socket.prototype.isXDomain=function(){var a=l.location.port||('https:'==l.location.protocol?443:80);return this.options.host!==l.location.hostname||this.options.port!=a};Socket.prototype.onConnect=function(){if(!this.connected){this.connected=true;this.connecting=false;if(!this.doBuffer){this.setBuffer(false)}this.emit('connect')}};Socket.prototype.onOpen=function(){this.open=true};Socket.prototype.onClose=function(){this.open=false};Socket.prototype.onPacket=function(a){this.of(a.endpoint).onPacket(a)};Socket.prototype.onError=function(a){if(a&&a.advice){if(a.advice==='reconnect'&&this.connected){this.disconnect();this.reconnect()}}this.publish('error',a&&a.reason?a.reason:a)};Socket.prototype.onDisconnect=function(a){var b=this.connected;this.connected=false;this.connecting=false;this.open=false;if(b){this.transport.close();this.transport.clearTimeouts();this.publish('disconnect',a);if('booted'!=a&&this.options.reconnect&&!this.reconnecting){this.reconnect()}}};Socket.prototype.reconnect=function(){this.reconnecting=true;this.reconnectionAttempts=0;this.reconnectionDelay=this.options['reconnection delay'];var a=this,maxAttempts=this.options['max reconnection attempts'],tryMultiple=this.options['try multiple transports'],limit=this.options['reconnection limit'];function reset(){if(a.connected){for(var i in a.namespaces){if(a.namespaces.hasOwnProperty(i)&&''!==i){a.namespaces[i].packet({type:'connect'})}}a.publish('reconnect',a.transport.name,a.reconnectionAttempts)}a.removeListener('connect_failed',maybeReconnect);a.removeListener('connect',maybeReconnect);a.reconnecting=false;delete a.reconnectionAttempts;delete a.reconnectionDelay;delete a.reconnectionTimer;delete a.redoTransports;a.options['try multiple transports']=tryMultiple};function maybeReconnect(){if(!a.reconnecting){return}if(a.connected){return reset()};if(a.connecting&&a.reconnecting){return a.reconnectionTimer=setTimeout(maybeReconnect,1000)}if(a.reconnectionAttempts++>=maxAttempts){if(!a.redoTransports){a.on('connect_failed',maybeReconnect);a.options['try multiple transports']=true;a.transport=a.getTransport();a.redoTransports=true;a.connect()}else{a.publish('reconnect_failed');reset()}}else{if(a.reconnectionDelay<limit){a.reconnectionDelay*=2}a.connect();a.publish('reconnecting',a.reconnectionDelay,a.reconnectionAttempts);a.reconnectionTimer=setTimeout(maybeReconnect,a.reconnectionDelay)}};this.options['try multiple transports']=false;this.reconnectionTimer=setTimeout(maybeReconnect,this.reconnectionDelay);this.on('connect',maybeReconnect)}})('undefined'!=typeof io?io:module.exports,'undefined'!=typeof io?io:module.parent.exports,this);(function(d,e){d.SocketNamespace=SocketNamespace;function SocketNamespace(a,b){this.socket=a;this.name=b||'';this.flags={};this.json=new Flag(this,'json');this.ackPackets=0;this.acks={}};e.util.mixin(SocketNamespace,e.EventEmitter);SocketNamespace.prototype.$emit=e.EventEmitter.prototype.emit;SocketNamespace.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)};SocketNamespace.prototype.packet=function(a){a.endpoint=this.name;this.socket.packet(a);this.flags={};return this};SocketNamespace.prototype.send=function(a,b){var c={type:this.flags.json?'json':'message',data:a};if('function'==typeof b){c.id=++this.ackPackets;c.ack=true;this.acks[c.id]=b}return this.packet(c)};SocketNamespace.prototype.emit=function(a){var b=Array.prototype.slice.call(arguments,1),lastArg=b[b.length-1],packet={type:'event',name:a};if('function'==typeof lastArg){packet.id=++this.ackPackets;packet.ack='data';this.acks[packet.id]=lastArg;b=b.slice(0,b.length-1)}packet.args=b;return this.packet(packet)};SocketNamespace.prototype.disconnect=function(){if(this.name===''){this.socket.disconnect()}else{this.packet({type:'disconnect'});this.$emit('disconnect')}return this};SocketNamespace.prototype.onPacket=function(a){var b=this;function ack(){b.packet({type:'ack',args:e.util.toArray(arguments),ackId:a.id})};switch(a.type){case'connect':this.$emit('connect');break;case'disconnect':if(this.name===''){this.socket.onDisconnect(a.reason||'booted')}else{this.$emit('disconnect',a.reason)}break;case'message':case'json':var c=['message',a.data];if(a.ack=='data'){c.push(ack)}else if(a.ack){this.packet({type:'ack',ackId:a.id})}this.$emit.apply(this,c);break;case'event':var c=[a.name].concat(a.args);if(a.ack=='data')c.push(ack);this.$emit.apply(this,c);break;case'ack':if(this.acks[a.ackId]){this.acks[a.ackId].apply(this,a.args);delete this.acks[a.ackId]}break;case'error':if(a.advice){this.socket.onError(a)}else{if(a.reason=='unauthorized'){this.$emit('connect_failed',a.reason)}else{this.$emit('error',a.reason)}}break}};function Flag(a,b){this.namespace=a;this.name=b};Flag.prototype.send=function(){this.namespace.flags[this.name]=true;this.namespace.send.apply(this.namespace,arguments)};Flag.prototype.emit=function(){this.namespace.flags[this.name]=true;this.namespace.emit.apply(this.namespace,arguments)}})('undefined'!=typeof io?io:module.exports,'undefined'!=typeof io?io:module.parent.exports);(function(c,d,f){c.websocket=WS;function WS(a){d.Transport.apply(this,arguments)};d.util.inherit(WS,d.Transport);WS.prototype.name='websocket';WS.prototype.open=function(){var b=d.util.query(this.socket.options.query),self=this,Socket if(!Socket){Socket=f.MozWebSocket||f.WebSocket}this.websocket=new Socket(this.prepareUrl()+b);this.websocket.onopen=function(){self.onOpen();self.socket.setBuffer(false)};this.websocket.onmessage=function(a){self.onData(a.data)};this.websocket.onclose=function(){self.onClose();self.socket.setBuffer(true)};this.websocket.onerror=function(e){self.onError(e)};return this};WS.prototype.send=function(a){this.websocket.send(a);return this};WS.prototype.payload=function(a){for(var i=0,l=a.length;i<l;i++){this.packet(a[i])}return this};WS.prototype.close=function(){this.websocket.close();return this};WS.prototype.onError=function(e){this.socket.onError(e)};WS.prototype.scheme=function(){return this.socket.options.secure?'wss':'ws'};WS.check=function(){return('WebSocket'in f&&!('__addTask'in WebSocket))||'MozWebSocket'in f};WS.xdomainCheck=function(){return true};d.transports.push('websocket')})('undefined'!=typeof io?io.Transport:module.exports,'undefined'!=typeof io?io:module.parent.exports,this);